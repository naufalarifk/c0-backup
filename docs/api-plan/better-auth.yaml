openapi: 3.1.1
info:
  title: Better Auth
  description: API Reference for your Better Auth Instance
  version: 1.1.0

servers:
  - url: http://localhost:3000/

security:
  - apiKeyCookie: []
    bearerAuth: []

components:
  securitySchemes:
    apiKeyCookie:
      type: apiKey
      in: cookie
      name: apiKeyCookie
      description: API Key authentication via cookie
    bearerAuth:
      type: http
      scheme: bearer
      description: Bearer token authentication

  schemas:
    User:
      type: object
      required: [name, email, emailVerified, createdAt, updatedAt]
      properties:
        id: { type: string }
        name: { type: string }
        email: { type: string }
        emailVerified: { type: boolean, default: "Generated at runtime" }
        image: { type: string }
        createdAt: { type: string, default: "Generated at runtime" }
        updatedAt: { type: string, default: "Generated at runtime" }
        twoFactorEnabled: { type: boolean, default: false, readOnly: true }

    Session:
      type: object
      required: [expiresAt, token, createdAt, updatedAt, userId]
      properties:
        id: { type: string }
        expiresAt: { type: string }
        token: { type: string }
        createdAt: { type: string }
        updatedAt: { type: string }
        ipAddress: { type: string }
        userAgent: { type: string }
        userId: { type: string }

    Account:
      type: object
      required: [accountId, providerId, userId, createdAt, updatedAt]
      properties:
        id: { type: string }
        accountId: { type: string }
        providerId: { type: string }
        userId: { type: string }
        accessToken: { type: string }
        refreshToken: { type: string }
        idToken: { type: string }
        accessTokenExpiresAt: { type: string }
        refreshTokenExpiresAt: { type: string }
        scope: { type: string }
        password: { type: string }
        createdAt: { type: string }
        updatedAt: { type: string }

    Verification:
      type: object
      required: [identifier, value, expiresAt]
      properties:
        id: { type: string }
        identifier: { type: string }
        value: { type: string }
        expiresAt: { type: string }
        createdAt: { type: string, default: "Generated at runtime" }
        updatedAt: { type: string, default: "Generated at runtime" }

    TwoFactor:
      type: object
      required: [secret, backupCodes, userId]
      properties:
        id: { type: string }
        secret: { type: string }
        backupCodes: { type: string }
        userId: { type: string }

    UserResponse:
      type: object
      required: [id, email, emailVerified, createdAt, updatedAt]
      properties:
        id: { type: string }
        email: { type: string }
        name: { type: string, nullable: true }
        image: { type: string, nullable: true }
        emailVerified: { type: boolean }
        createdAt: { type: string, format: date-time }
        updatedAt: { type: string, format: date-time }
        twoFactorEnabled: { type: boolean }

    AuthResponse:
      type: object
      required: [redirect, token, user]
      properties:
        redirect: { type: boolean, enum: [false] }
        token: { type: string, description: "Session token" }
        url: { type: "null", nullable: true }
        user: { $ref: "#/components/schemas/UserResponse" }

    TokenResponse:
      type: object
      properties:
        tokenType: { type: string }
        idToken: { type: string }
        accessToken: { type: string }
        refreshToken: { type: string }
        accessTokenExpiresAt: { type: string, format: date-time }
        refreshTokenExpiresAt: { type: string, format: date-time }

    ErrorResponse:
      type: object
      required: [message]
      properties:
        message: { type: string }

    StatusResponse:
      type: object
      required: [status]
      properties:
        status: { type: boolean }

  responses:
    BadRequest:
      description: Bad Request. Usually due to missing parameters, or invalid parameters.
      content:
        application/json:
          schema: { $ref: "#/components/schemas/ErrorResponse" }
    
    Unauthorized:
      description: Unauthorized. Due to missing or invalid authentication.
      content:
        application/json:
          schema: { $ref: "#/components/schemas/ErrorResponse" }
    
    Forbidden:
      description: Forbidden. You do not have permission to access this resource or to perform this action.
      content:
        application/json:
          schema: { $ref: "#/components/schemas/ErrorResponse" }
    
    NotFound:
      description: Not Found. The requested resource was not found.
      content:
        application/json:
          schema: { $ref: "#/components/schemas/ErrorResponse" }
    
    TooManyRequests:
      description: Too Many Requests. You have exceeded the rate limit. Try again later.
      content:
        application/json:
          schema: { $ref: "#/components/schemas/ErrorResponse" }
    
    InternalServerError:
      description: Internal Server Error. This is a problem with the server that you cannot fix.
      content:
        application/json:
          schema: { $ref: "#/components/schemas/ErrorResponse" }

paths:
  # Auth Endpoints
  /api/auth/sign-in/social:
    post:
      tags: [Default]
      description: Sign in with a social provider
      operationId: socialSignIn
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [provider]
              properties:
                callbackURL: { type: string }
                newUserCallbackURL: { type: string }
                errorCallbackURL: { type: string }
                provider: { type: string }
                disableRedirect: { type: string }
                idToken: { type: string }
                scopes: { type: string }
                requestSignUp: { type: string }
                loginHint: { type: string }
      responses:
        "200":
          description: Success - Returns either session details or redirect URL
          content:
            application/json:
              schema: { $ref: "#/components/schemas/AuthResponse" }
        "400": { $ref: "#/components/responses/BadRequest" }
        "401": { $ref: "#/components/responses/Unauthorized" }
        "403": { $ref: "#/components/responses/Forbidden" }
        "404": { $ref: "#/components/responses/NotFound" }
        "429": { $ref: "#/components/responses/TooManyRequests" }
        "500": { $ref: "#/components/responses/InternalServerError" }

  /api/auth/get-session:
    get:
      tags: [Default]
      description: Get the current session
      responses:
        "200":
          description: Success
          content:
            application/json:
              schema:
                type: object
                required: [session, user]
                properties:
                  session: { $ref: "#/components/schemas/Session" }
                  user: { $ref: "#/components/schemas/User" }
        "400": { $ref: "#/components/responses/BadRequest" }
        "401": { $ref: "#/components/responses/Unauthorized" }
        "403": { $ref: "#/components/responses/Forbidden" }
        "404": { $ref: "#/components/responses/NotFound" }
        "429": { $ref: "#/components/responses/TooManyRequests" }
        "500": { $ref: "#/components/responses/InternalServerError" }

  /api/auth/sign-out:
    post:
      tags: [Default]
      description: Sign out the current user
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties: {}
      responses:
        "200":
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success: { type: boolean }
        "400": { $ref: "#/components/responses/BadRequest" }
        "401": { $ref: "#/components/responses/Unauthorized" }
        "403": { $ref: "#/components/responses/Forbidden" }
        "404": { $ref: "#/components/responses/NotFound" }
        "429": { $ref: "#/components/responses/TooManyRequests" }
        "500": { $ref: "#/components/responses/InternalServerError" }

  /api/auth/sign-up/email:
    post:
      tags: [Default]
      description: Sign up a user using email and password
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required: [name, email, password]
              properties:
                name: { type: string, description: "The name of the user" }
                email: { type: string, description: "The email of the user" }
                password: { type: string, description: "The password of the user" }
                image: { type: string, description: "The profile image URL of the user" }
                callbackURL: { type: string, description: "The URL to use for email verification callback" }
                rememberMe: { type: boolean, description: "If this is false, the session will not be remembered. Default is `true`." }
      responses:
        "200":
          description: Successfully created user
          content:
            application/json:
              schema:
                type: object
                required: [user]
                properties:
                  token: { type: string, nullable: true, description: "Authentication token for the session" }
                  user: { $ref: "#/components/schemas/UserResponse" }
        "400": { $ref: "#/components/responses/BadRequest" }
        "401": { $ref: "#/components/responses/Unauthorized" }
        "403": { $ref: "#/components/responses/Forbidden" }
        "404": { $ref: "#/components/responses/NotFound" }
        "429": { $ref: "#/components/responses/TooManyRequests" }
        "500": { $ref: "#/components/responses/InternalServerError" }

  /api/auth/sign-in/email:
    post:
      tags: [Default]
      description: Sign in with email and password
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [email, password]
              properties:
                email: { type: string, description: "Email of the user" }
                password: { type: string, description: "Password of the user" }
                callbackURL: { type: string }
                rememberMe: { type: string }
      responses:
        "200":
          description: Success - Returns either session details or redirect URL
          content:
            application/json:
              schema: { $ref: "#/components/schemas/AuthResponse" }
        "400": { $ref: "#/components/responses/BadRequest" }
        "401": { $ref: "#/components/responses/Unauthorized" }
        "403": { $ref: "#/components/responses/Forbidden" }
        "404": { $ref: "#/components/responses/NotFound" }
        "429": { $ref: "#/components/responses/TooManyRequests" }
        "500": { $ref: "#/components/responses/InternalServerError" }

  /api/auth/forget-password:
    post:
      tags: [Default]
      description: Send a password reset email to the user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [email]
              properties:
                email: { type: string, description: "The email address of the user to send a password reset email to" }
                redirectTo: { type: string }
      responses:
        "200":
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: { type: boolean }
                  message: { type: string }
        "400": { $ref: "#/components/responses/BadRequest" }
        "401": { $ref: "#/components/responses/Unauthorized" }
        "403": { $ref: "#/components/responses/Forbidden" }
        "404": { $ref: "#/components/responses/NotFound" }
        "429": { $ref: "#/components/responses/TooManyRequests" }
        "500": { $ref: "#/components/responses/InternalServerError" }

  /api/auth/reset-password:
    post:
      tags: [Default]
      description: Reset the password for a user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [newPassword]
              properties:
                newPassword: { type: string, description: "The new password to set" }
                token: { type: string }
      responses:
        "200":
          description: Success
          content:
            application/json:
              schema: { $ref: "#/components/schemas/StatusResponse" }
        "400": { $ref: "#/components/responses/BadRequest" }
        "401": { $ref: "#/components/responses/Unauthorized" }
        "403": { $ref: "#/components/responses/Forbidden" }
        "404": { $ref: "#/components/responses/NotFound" }
        "429": { $ref: "#/components/responses/TooManyRequests" }
        "500": { $ref: "#/components/responses/InternalServerError" }

  /api/auth/verify-email:
    get:
      tags: [Default]
      description: Verify the email of the user
      parameters:
        - name: token
          in: query
          required: true
          description: The token to verify the email
          schema: { type: string }
        - name: callbackURL
          in: query
          required: false
          description: The URL to redirect to after email verification
          schema: { type: string }
      responses:
        "200":
          description: Success
          content:
            application/json:
              schema:
                type: object
                required: [user, status]
                properties:
                  user: { $ref: "#/components/schemas/UserResponse" }
                  status: { type: boolean, description: "Indicates if the email was verified successfully" }
        "400": { $ref: "#/components/responses/BadRequest" }
        "401": { $ref: "#/components/responses/Unauthorized" }
        "403": { $ref: "#/components/responses/Forbidden" }
        "404": { $ref: "#/components/responses/NotFound" }
        "429": { $ref: "#/components/responses/TooManyRequests" }
        "500": { $ref: "#/components/responses/InternalServerError" }

  /api/auth/send-verification-email:
    post:
      tags: [Default]
      description: Send a verification email to the user
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required: [email]
              properties:
                email: { type: string, description: "The email to send the verification email to", example: "user@example.com" }
                callbackURL: { type: string, description: "The URL to use for email verification callback", example: "https://example.com/callback", nullable: true }
      responses:
        "200":
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: { type: boolean, description: "Indicates if the email was sent successfully", example: true }
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  message: { type: string, description: "Error message", example: "Verification email isn't enabled" }
        "401": { $ref: "#/components/responses/Unauthorized" }
        "403": { $ref: "#/components/responses/Forbidden" }
        "404": { $ref: "#/components/responses/NotFound" }
        "429": { $ref: "#/components/responses/TooManyRequests" }
        "500": { $ref: "#/components/responses/InternalServerError" }

  /api/auth/change-email:
    post:
      tags: [Default]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [newEmail]
              properties:
                newEmail: { type: string, description: "The new email address to set must be a valid email address" }
                callbackURL: { type: string }
      responses:
        "200":
          description: Email change request processed successfully
          content:
            application/json:
              schema:
                type: object
                required: [status]
                properties:
                  status: { type: boolean, description: "Indicates if the request was successful" }
                  message: { type: string, enum: ["Email updated", "Verification email sent"], description: "Status message of the email change process", nullable: true }
        "400": { $ref: "#/components/responses/BadRequest" }
        "401": { $ref: "#/components/responses/Unauthorized" }
        "403": { $ref: "#/components/responses/Forbidden" }
        "404": { $ref: "#/components/responses/NotFound" }
        "429": { $ref: "#/components/responses/TooManyRequests" }
        "500": { $ref: "#/components/responses/InternalServerError" }

  /api/auth/change-password:
    post:
      tags: [Default]
      description: Change the password of the user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [newPassword, currentPassword]
              properties:
                newPassword: { type: string, description: "The new password to set" }
                currentPassword: { type: string, description: "The current password is required" }
                revokeOtherSessions: { type: string }
      responses:
        "200":
          description: Password successfully changed
          content:
            application/json:
              schema:
                type: object
                required: [user]
                properties:
                  token: { type: string, nullable: true, description: "New session token if other sessions were revoked" }
                  user: { $ref: "#/components/schemas/UserResponse" }
        "400": { $ref: "#/components/responses/BadRequest" }
        "401": { $ref: "#/components/responses/Unauthorized" }
        "403": { $ref: "#/components/responses/Forbidden" }
        "404": { $ref: "#/components/responses/NotFound" }
        "429": { $ref: "#/components/responses/TooManyRequests" }
        "500": { $ref: "#/components/responses/InternalServerError" }

  /api/auth/update-user:
    post:
      tags: [Default]
      description: Update the current user
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name: { type: string, description: "The name of the user" }
                image: { type: string, description: "The image of the user" }
      responses:
        "200":
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: { type: boolean, description: "Indicates if the update was successful" }
        "400": { $ref: "#/components/responses/BadRequest" }
        "401": { $ref: "#/components/responses/Unauthorized" }
        "403": { $ref: "#/components/responses/Forbidden" }
        "404": { $ref: "#/components/responses/NotFound" }
        "429": { $ref: "#/components/responses/TooManyRequests" }
        "500": { $ref: "#/components/responses/InternalServerError" }

  /api/auth/delete-user:
    post:
      tags: [Default]
      description: Delete the user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                callbackURL: { type: string }
                password: { type: string }
                token: { type: string }
      responses:
        "200":
          description: User deletion processed successfully
          content:
            application/json:
              schema:
                type: object
                required: [success, message]
                properties:
                  success: { type: boolean, description: "Indicates if the operation was successful" }
                  message: { type: string, enum: ["User deleted", "Verification email sent"], description: "Status message of the deletion process" }
        "400": { $ref: "#/components/responses/BadRequest" }
        "401": { $ref: "#/components/responses/Unauthorized" }
        "403": { $ref: "#/components/responses/Forbidden" }
        "404": { $ref: "#/components/responses/NotFound" }
        "429": { $ref: "#/components/responses/TooManyRequests" }
        "500": { $ref: "#/components/responses/InternalServerError" }

  /api/auth/reset-password/{token}:
    get:
      tags: [Default]
      description: Redirects the user to the callback URL with the token
      parameters:
        - name: callbackURL
          in: query
          schema:
            type: string
            description: The URL to redirect the user to reset their password
      responses:
        "200":
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  token: { type: string }
        "400": { $ref: "#/components/responses/BadRequest" }
        "401": { $ref: "#/components/responses/Unauthorized" }
        "403": { $ref: "#/components/responses/Forbidden" }
        "404": { $ref: "#/components/responses/NotFound" }
        "429": { $ref: "#/components/responses/TooManyRequests" }
        "500": { $ref: "#/components/responses/InternalServerError" }

  /api/auth/request-password-reset:
    post:
      tags: [Default]
      description: Send a password reset email to the user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [email]
              properties:
                email: { type: string, description: "The email address of the user to send a password reset email to" }
                redirectTo: { type: string }
      responses:
        "200":
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  status: { type: boolean }
                  message: { type: string }
        "400": { $ref: "#/components/responses/BadRequest" }
        "401": { $ref: "#/components/responses/Unauthorized" }
        "403": { $ref: "#/components/responses/Forbidden" }
        "404": { $ref: "#/components/responses/NotFound" }
        "429": { $ref: "#/components/responses/TooManyRequests" }
        "500": { $ref: "#/components/responses/InternalServerError" }

  /api/auth/list-sessions:
    get:
      tags: [Default]
      description: List all active sessions for the user
      responses:
        "200":
          description: Success
          content:
            application/json:
              schema:
                type: array
                items: { $ref: "#/components/schemas/Session" }
        "400": { $ref: "#/components/responses/BadRequest" }
        "401": { $ref: "#/components/responses/Unauthorized" }
        "403": { $ref: "#/components/responses/Forbidden" }
        "404": { $ref: "#/components/responses/NotFound" }
        "429": { $ref: "#/components/responses/TooManyRequests" }
        "500": { $ref: "#/components/responses/InternalServerError" }

  /api/auth/revoke-session:
    post:
      tags: [Default]
      description: Revoke a single session
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required: [token]
              properties:
                token: { type: string, description: "The token to revoke" }
      responses:
        "200":
          description: Success
          content:
            application/json:
              schema:
                type: object
                required: [status]
                properties:
                  status: { type: boolean, description: "Indicates if the session was revoked successfully" }
        "400": { $ref: "#/components/responses/BadRequest" }
        "401": { $ref: "#/components/responses/Unauthorized" }
        "403": { $ref: "#/components/responses/Forbidden" }
        "404": { $ref: "#/components/responses/NotFound" }
        "429": { $ref: "#/components/responses/TooManyRequests" }
        "500": { $ref: "#/components/responses/InternalServerError" }

  /api/auth/revoke-sessions:
    post:
      tags: [Default]
      description: Revoke all sessions for the user
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties: {}
      responses:
        "200":
          description: Success
          content:
            application/json:
              schema:
                type: object
                required: [status]
                properties:
                  status: { type: boolean, description: "Indicates if all sessions were revoked successfully" }
        "400": { $ref: "#/components/responses/BadRequest" }
        "401": { $ref: "#/components/responses/Unauthorized" }
        "403": { $ref: "#/components/responses/Forbidden" }
        "404": { $ref: "#/components/responses/NotFound" }
        "429": { $ref: "#/components/responses/TooManyRequests" }
        "500": { $ref: "#/components/responses/InternalServerError" }

  /api/auth/revoke-other-sessions:
    post:
      tags: [Default]
      description: Revoke all other sessions for the user except the current one
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties: {}
      responses:
        "200":
          description: Success
          content:
            application/json:
              schema:
                type: object
                required: [status]
                properties:
                  status: { type: boolean, description: "Indicates if all other sessions were revoked successfully" }
        "400": { $ref: "#/components/responses/BadRequest" }
        "401": { $ref: "#/components/responses/Unauthorized" }
        "403": { $ref: "#/components/responses/Forbidden" }
        "404": { $ref: "#/components/responses/NotFound" }
        "429": { $ref: "#/components/responses/TooManyRequests" }
        "500": { $ref: "#/components/responses/InternalServerError" }

  /api/auth/link-social:
    post:
      tags: [Default]
      description: Link a social account to the user
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [provider]
              properties:
                callbackURL: { type: string }
                provider: { type: string }
                idToken: { type: string }
                requestSignUp: { type: string }
                scopes: { type: string }
                errorCallbackURL: { type: string }
                disableRedirect: { type: string }
      responses:
        "200":
          description: Success
          content:
            application/json:
              schema:
                type: object
                required: [redirect]
                properties:
                  url: { type: string, description: "The authorization URL to redirect the user to" }
                  redirect: { type: boolean, description: "Indicates if the user should be redirected to the authorization URL" }
                  status: { type: boolean }
        "400": { $ref: "#/components/responses/BadRequest" }
        "401": { $ref: "#/components/responses/Unauthorized" }
        "403": { $ref: "#/components/responses/Forbidden" }
        "404": { $ref: "#/components/responses/NotFound" }
        "429": { $ref: "#/components/responses/TooManyRequests" }
        "500": { $ref: "#/components/responses/InternalServerError" }

  /api/auth/list-accounts:
    get:
      tags: [Default]
      description: List all accounts linked to the user
      responses:
        "200":
          description: Success
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  required: [id, provider, createdAt, updatedAt, accountId, scopes]
                  properties:
                    id: { type: string }
                    provider: { type: string }
                    createdAt: { type: string, format: date-time }
                    updatedAt: { type: string, format: date-time }
                    accountId: { type: string }
                    scopes:
                      type: array
                      items: { type: string }
        "400": { $ref: "#/components/responses/BadRequest" }
        "401": { $ref: "#/components/responses/Unauthorized" }
        "403": { $ref: "#/components/responses/Forbidden" }
        "404": { $ref: "#/components/responses/NotFound" }
        "429": { $ref: "#/components/responses/TooManyRequests" }
        "500": { $ref: "#/components/responses/InternalServerError" }

  /api/auth/delete-user/callback:
    get:
      tags: [Default]
      description: Callback to complete user deletion with verification token
      parameters:
        - name: token
          in: query
          schema:
            type: string
            description: The token to verify the deletion request
        - name: callbackURL
          in: query
          schema: { type: string }
      responses:
        "200":
          description: User successfully deleted
          content:
            application/json:
              schema:
                type: object
                required: [success, message]
                properties:
                  success: { type: boolean, description: "Indicates if the deletion was successful" }
                  message: { type: string, enum: ["User deleted"], description: "Confirmation message" }
        "400": { $ref: "#/components/responses/BadRequest" }
        "401": { $ref: "#/components/responses/Unauthorized" }
        "403": { $ref: "#/components/responses/Forbidden" }
        "404": { $ref: "#/components/responses/NotFound" }
        "429": { $ref: "#/components/responses/TooManyRequests" }
        "500": { $ref: "#/components/responses/InternalServerError" }

  /api/auth/unlink-account:
    post:
      tags: [Default]
      description: Unlink an account
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [providerId]
              properties:
                providerId: { type: string }
                accountId: { type: string }
      responses:
        "200":
          description: Success
          content:
            application/json:
              schema: { $ref: "#/components/schemas/StatusResponse" }
        "400": { $ref: "#/components/responses/BadRequest" }
        "401": { $ref: "#/components/responses/Unauthorized" }
        "403": { $ref: "#/components/responses/Forbidden" }
        "404": { $ref: "#/components/responses/NotFound" }
        "429": { $ref: "#/components/responses/TooManyRequests" }
        "500": { $ref: "#/components/responses/InternalServerError" }

  /api/auth/refresh-token:
    post:
      tags: [Default]
      description: Refresh the access token using a refresh token
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [providerId]
              properties:
                providerId: { type: string, description: "The provider ID for the OAuth provider" }
                accountId: { type: string }
                userId: { type: string }
      responses:
        "200":
          description: Access token refreshed successfully
          content:
            application/json:
              schema: { $ref: "#/components/schemas/TokenResponse" }
        "400":
          description: Invalid refresh token or provider configuration
        "401": { $ref: "#/components/responses/Unauthorized" }
        "403": { $ref: "#/components/responses/Forbidden" }
        "404": { $ref: "#/components/responses/NotFound" }
        "429": { $ref: "#/components/responses/TooManyRequests" }
        "500": { $ref: "#/components/responses/InternalServerError" }

  /api/auth/get-access-token:
    post:
      tags: [Default]
      description: Get a valid access token, doing a refresh if needed
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [providerId]
              properties:
                providerId: { type: string, description: "The provider ID for the OAuth provider" }
                accountId: { type: string }
                userId: { type: string }
      responses:
        "200":
          description: A Valid access token
          content:
            application/json:
              schema: { $ref: "#/components/schemas/TokenResponse" }
        "400":
          description: Invalid refresh token or provider configuration
        "401": { $ref: "#/components/responses/Unauthorized" }
        "403": { $ref: "#/components/responses/Forbidden" }
        "404": { $ref: "#/components/responses/NotFound" }
        "429": { $ref: "#/components/responses/TooManyRequests" }
        "500": { $ref: "#/components/responses/InternalServerError" }

  /api/auth/account-info:
    post:
      tags: [Default]
      description: Get the account info provided by the provider
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [accountId]
              properties:
                accountId: { type: string, description: "The provider given account id for which to get the account info" }
      responses:
        "200":
          description: Success
          content:
            application/json:
              schema:
                type: object
                required: [user, data]
                additionalProperties: false
                properties:
                  user:
                    type: object
                    required: [id, emailVerified]
                    properties:
                      id: { type: string }
                      name: { type: string }
                      email: { type: string }
                      image: { type: string }
                      emailVerified: { type: boolean }
                  data:
                    type: object
                    additionalProperties: true
        "400": { $ref: "#/components/responses/BadRequest" }
        "401": { $ref: "#/components/responses/Unauthorized" }
        "403": { $ref: "#/components/responses/Forbidden" }
        "404": { $ref: "#/components/responses/NotFound" }
        "429": { $ref: "#/components/responses/TooManyRequests" }
        "500": { $ref: "#/components/responses/InternalServerError" }

  /api/auth/ok:
    get:
      tags: [Default]
      description: Check if the API is working
      responses:
        "200":
          description: API is working
          content:
            application/json:
              schema:
                type: object
                required: [ok]
                properties:
                  ok: { type: boolean, description: "Indicates if the API is working" }
        "400": { $ref: "#/components/responses/BadRequest" }
        "401": { $ref: "#/components/responses/Unauthorized" }
        "403": { $ref: "#/components/responses/Forbidden" }
        "404": { $ref: "#/components/responses/NotFound" }
        "429": { $ref: "#/components/responses/TooManyRequests" }
        "500": { $ref: "#/components/responses/InternalServerError" }

  /api/auth/error:
    get:
      tags: [Default]
      description: Displays an error page
      responses:
        "200":
          description: Success
          content:
            text/html:
              schema:
                type: string
                description: The HTML content of the error page
        "400": { $ref: "#/components/responses/BadRequest" }
        "401": { $ref: "#/components/responses/Unauthorized" }
        "403": { $ref: "#/components/responses/Forbidden" }
        "404": { $ref: "#/components/responses/NotFound" }
        "429": { $ref: "#/components/responses/TooManyRequests" }
        "500": { $ref: "#/components/responses/InternalServerError" }

  # Two-factor endpoints
  /api/auth/two-factor/get-totp-uri:
    post:
      tags: [Two-factor]
      description: Use this endpoint to get the TOTP URI
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [password]
              properties:
                password: { type: string, description: "User password" }
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  totpURI: { type: string }
        "400": { $ref: "#/components/responses/BadRequest" }
        "401": { $ref: "#/components/responses/Unauthorized" }
        "403": { $ref: "#/components/responses/Forbidden" }
        "404": { $ref: "#/components/responses/NotFound" }
        "429": { $ref: "#/components/responses/TooManyRequests" }
        "500": { $ref: "#/components/responses/InternalServerError" }

  /api/auth/two-factor/verify-totp:
    post:
      tags: [Two-factor]
      description: Verify two factor TOTP
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [code]
              properties:
                code: { type: string, description: 'The otp code to verify. Eg: "012345"' }
                trustDevice: { type: string }
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema: { $ref: "#/components/schemas/StatusResponse" }
        "400": { $ref: "#/components/responses/BadRequest" }
        "401": { $ref: "#/components/responses/Unauthorized" }
        "403": { $ref: "#/components/responses/Forbidden" }
        "404": { $ref: "#/components/responses/NotFound" }
        "429": { $ref: "#/components/responses/TooManyRequests" }
        "500": { $ref: "#/components/responses/InternalServerError" }

  /api/auth/two-factor/send-otp:
    post:
      tags: [Two-factor]
      description: Send two factor OTP to the user
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema: { $ref: "#/components/schemas/StatusResponse" }
        "400": { $ref: "#/components/responses/BadRequest" }
        "401": { $ref: "#/components/responses/Unauthorized" }
        "403": { $ref: "#/components/responses/Forbidden" }
        "404": { $ref: "#/components/responses/NotFound" }
        "429": { $ref: "#/components/responses/TooManyRequests" }
        "500": { $ref: "#/components/responses/InternalServerError" }

  /api/auth/two-factor/verify-otp:
    post:
      tags: [Two-factor]
      description: Verify two factor OTP
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [code]
              properties:
                code: { type: string, description: 'The otp code to verify. Eg: "012345"' }
                trustDevice: { type: string, description: "If true, the device will be trusted for 30 days. It'll be refreshed on every sign in request within this time. Eg: true" }
      responses:
        "200":
          description: Two-factor OTP verified successfully
          content:
            application/json:
              schema:
                type: object
                required: [token, user]
                properties:
                  token: { type: string, description: "Session token for the authenticated session" }
                  user: { $ref: "#/components/schemas/UserResponse" }
        "400": { $ref: "#/components/responses/BadRequest" }
        "401": { $ref: "#/components/responses/Unauthorized" }
        "403": { $ref: "#/components/responses/Forbidden" }
        "404": { $ref: "#/components/responses/NotFound" }
        "429": { $ref: "#/components/responses/TooManyRequests" }
        "500": { $ref: "#/components/responses/InternalServerError" }

  /api/auth/two-factor/verify-backup-code:
    post:
      tags: [Two-factor]
      description: Verify a backup code for two-factor authentication
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [code]
              properties:
                code: { type: string, description: 'A backup code to verify. Eg: "123456"' }
                disableSession: { type: string }
                trustDevice: { type: string }
      responses:
        "200":
          description: Backup code verified successfully
          content:
            application/json:
              schema:
                type: object
                required: [user, session]
                properties:
                  user: { $ref: "#/components/schemas/UserResponse" }
                  session:
                    type: object
                    required: [token, userId, createdAt, expiresAt]
                    description: The current session object, included unless disableSession is true
                    properties:
                      token: { type: string, description: "Session token" }
                      userId: { type: string, description: "ID of the user associated with the session" }
                      createdAt: { type: string, format: date-time, description: "Timestamp when the session was created" }
                      expiresAt: { type: string, format: date-time, description: "Timestamp when the session expires" }
        "400": { $ref: "#/components/responses/BadRequest" }
        "401": { $ref: "#/components/responses/Unauthorized" }
        "403": { $ref: "#/components/responses/Forbidden" }
        "404": { $ref: "#/components/responses/NotFound" }
        "429": { $ref: "#/components/responses/TooManyRequests" }
        "500": { $ref: "#/components/responses/InternalServerError" }

  /api/auth/two-factor/generate-backup-codes:
    post:
      tags: [Two-factor]
      description: Generate new backup codes for two-factor authentication
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [password]
              properties:
                password: { type: string, description: "The users password." }
      responses:
        "200":
          description: Backup codes generated successfully
          content:
            application/json:
              schema:
                type: object
                required: [status, backupCodes]
                properties:
                  status: { type: boolean, description: "Indicates if the backup codes were generated successfully", enum: [true] }
                  backupCodes:
                    type: array
                    items: { type: string }
                    description: Array of generated backup codes in plain text
        "400": { $ref: "#/components/responses/BadRequest" }
        "401": { $ref: "#/components/responses/Unauthorized" }
        "403": { $ref: "#/components/responses/Forbidden" }
        "404": { $ref: "#/components/responses/NotFound" }
        "429": { $ref: "#/components/responses/TooManyRequests" }
        "500": { $ref: "#/components/responses/InternalServerError" }

  /api/auth/two-factor/enable:
    post:
      tags: [Two-factor]
      description: Use this endpoint to enable two factor authentication. This will generate a TOTP URI and backup codes. Once the user verifies the TOTP URI, the two factor authentication will be enabled.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [password]
              properties:
                password: { type: string, description: "User password" }
                issuer: { type: string }
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  totpURI: { type: string, description: "TOTP URI" }
                  backupCodes:
                    type: array
                    items: { type: string }
                    description: Backup codes
        "400": { $ref: "#/components/responses/BadRequest" }
        "401": { $ref: "#/components/responses/Unauthorized" }
        "403": { $ref: "#/components/responses/Forbidden" }
        "404": { $ref: "#/components/responses/NotFound" }
        "429": { $ref: "#/components/responses/TooManyRequests" }
        "500": { $ref: "#/components/responses/InternalServerError" }

  /api/auth/two-factor/disable:
    post:
      tags: [Two-factor]
      description: Use this endpoint to disable two factor authentication.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [password]
              properties:
                password: { type: string, description: "User password" }
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema: { $ref: "#/components/schemas/StatusResponse" }
        "400": { $ref: "#/components/responses/BadRequest" }
        "401": { $ref: "#/components/responses/Unauthorized" }
        "403": { $ref: "#/components/responses/Forbidden" }
        "404": { $ref: "#/components/responses/NotFound" }
        "429": { $ref: "#/components/responses/TooManyRequests" }
        "500": { $ref: "#/components/responses/InternalServerError" }

  # Multi-session endpoints
  /api/auth/multi-session/list-device-sessions:
    get:
      tags: [Multi-session]
      responses:
        "400": { $ref: "#/components/responses/BadRequest" }
        "401": { $ref: "#/components/responses/Unauthorized" }
        "403": { $ref: "#/components/responses/Forbidden" }
        "404": { $ref: "#/components/responses/NotFound" }
        "429": { $ref: "#/components/responses/TooManyRequests" }
        "500": { $ref: "#/components/responses/InternalServerError" }

  /api/auth/multi-session/set-active:
    post:
      tags: [Multi-session]
      description: Set the active session
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [sessionToken]
              properties:
                sessionToken: { type: string, description: "The session token to set as active" }
      responses:
        "200":
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  session: { $ref: "#/components/schemas/Session" }
        "400": { $ref: "#/components/responses/BadRequest" }
        "401": { $ref: "#/components/responses/Unauthorized" }
        "403": { $ref: "#/components/responses/Forbidden" }
        "404": { $ref: "#/components/responses/NotFound" }
        "429": { $ref: "#/components/responses/TooManyRequests" }
        "500": { $ref: "#/components/responses/InternalServerError" }

  /api/auth/multi-session/revoke:
    post:
      tags: [Multi-session]
      description: Revoke a device session
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [sessionToken]
              properties:
                sessionToken: { type: string, description: "The session token to revoke" }
      responses:
        "200":
          description: Success
          content:
            application/json:
              schema: { $ref: "#/components/schemas/StatusResponse" }
        "400": { $ref: "#/components/responses/BadRequest" }
        "401": { $ref: "#/components/responses/Unauthorized" }
        "403": { $ref: "#/components/responses/Forbidden" }
        "404": { $ref: "#/components/responses/NotFound" }
        "429": { $ref: "#/components/responses/TooManyRequests" }
        "500": { $ref: "#/components/responses/InternalServerError" }

tags:
  - name: Default
    description: Default endpoints that are included with Better Auth by default. These endpoints are not part of any plugin.
  - name: Two-factor
    description: Two-factor authentication endpoints
  - name: Multi-session
    description: Multi-session management endpoints