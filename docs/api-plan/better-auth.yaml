openapi: 3.1.1
info:
  title: Better Auth
  description: API Reference for your Better Auth Instance
  version: 1.1.0

# YAML Anchors for reusable components
x-common-responses: &common-error-responses
  '400':
    description: Bad Request. Usually due to missing parameters, or invalid parameters.
    content:
      application/json:
        schema:
          $ref: '#/components/schemas/ErrorResponse'
  '401':
    description: Unauthorized. Due to missing or invalid authentication.
    content:
      application/json:
        schema:
          $ref: '#/components/schemas/ErrorResponse'
  '403':
    description: Forbidden. You do not have permission to access this resource or to perform this action.
    content:
      application/json:
        schema:
          $ref: '#/components/schemas/ErrorResponse'
  '404':
    description: Not Found. The requested resource was not found.
    content:
      application/json:
        schema:
          $ref: '#/components/schemas/ErrorResponse'
  '429':
    description: Too Many Requests. You have exceeded the rate limit. Try again later.
    content:
      application/json:
        schema:
          $ref: '#/components/schemas/ErrorResponse'
  '500':
    description: Internal Server Error. This is a problem with the server that you cannot fix.
    content:
      application/json:
        schema:
          $ref: '#/components/schemas/ErrorResponse'

x-auth-success-response: &auth-success-response
  type: object
  properties:
    redirect:
      type: boolean
      enum: [false]
    token:
      type: string
      description: Session token
    user:
      $ref: '#/components/schemas/User'
  required: [redirect, token, user]

x-status-response: &status-response
  type: object
  properties:
    status:
      type: boolean
  required: [status]

components:
  schemas:
    ErrorResponse:
      type: object
      properties:
        message:
          type: string
      required: [message]
    
    StatusResponse:
      <<: *status-response
    
    AuthSuccessResponse:
      <<: *auth-success-response
    
    SessionResponse:
      type: object
      properties:
        session:
          $ref: '#/components/schemas/Session'
        user:
          $ref: '#/components/schemas/User'
      required: [session, user]
    
    TokenResponse:
      type: object
      properties:
        tokenType:
          type: string
        idToken:
          type: string
          nullable: true
        accessToken:
          type: string
        refreshToken:
          type: string
          nullable: true
        accessTokenExpiresAt:
          type: string
          format: date-time
          nullable: true
        refreshTokenExpiresAt:
          type: string
          format: date-time
          nullable: true
    
    UserWithToken:
      type: object
      properties:
        token:
          type: string
          nullable: true
        user:
          $ref: '#/components/schemas/User'
      required: [user]
    
    StatusWithMessage:
      type: object
      properties:
        status:
          type: boolean
        message:
          type: string
          nullable: true
      required: [status]

    User:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        email:
          type: string
          format: email
        emailVerified:
          type: boolean
          default: Generated at runtime
        image:
          type: string
          format: uri
          nullable: true
        createdAt:
          type: string
          format: date-time
          default: Generated at runtime
        updatedAt:
          type: string
          format: date-time
          default: Generated at runtime
        twoFactorEnabled:
          type: boolean
          default: false
          readOnly: true
      required: [name, email, emailVerified, createdAt, updatedAt]

    Session:
      type: object
      properties:
        id:
          type: string
        expiresAt:
          type: string
          format: date-time
        token:
          type: string
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
        ipAddress:
          type: string
        userAgent:
          type: string
        userId:
          type: string
      required: [expiresAt, token, createdAt, updatedAt, userId]

    Account:
      type: object
      properties:
        id:
          type: string
        accountId:
          type: string
        providerId:
          type: string
        userId:
          type: string
        accessToken:
          type: string
        refreshToken:
          type: string
        idToken:
          type: string
        accessTokenExpiresAt:
          type: string
          format: date-time
        refreshTokenExpiresAt:
          type: string
          format: date-time
        scope:
          type: string
        password:
          type: string
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
      required: [accountId, providerId, userId, createdAt, updatedAt]

    Verification:
      type: object
      properties:
        id:
          type: string
        identifier:
          type: string
        value:
          type: string
        expiresAt:
          type: string
          format: date-time
        createdAt:
          type: string
          format: date-time
          default: Generated at runtime
        updatedAt:
          type: string
          format: date-time
          default: Generated at runtime
      required: [identifier, value, expiresAt]

    TwoFactor:
      type: object
      properties:
        id:
          type: string
        secret:
          type: string
        backupCodes:
          type: string
        userId:
          type: string
      required: [secret, backupCodes, userId]

  securitySchemes:
    apiKeyCookie:
      type: apiKey
      in: cookie
      name: apiKeyCookie
      description: API Key authentication via cookie
    bearerAuth:
      type: http
      scheme: bearer
      description: Bearer token authentication

security:
  - apiKeyCookie: []
    bearerAuth: []

servers:
  - url: http://localhost:3000/api/auth

tags:
  - name: Default
    description: Default endpoints that are included with Better Auth by default. These endpoints are not part of any plugin.
  - name: Two-factor
    description: Two-factor authentication endpoints
  - name: Multi-session
    description: Multi-session management endpoints

paths:
  /sign-in/social:
    post:
      tags: [Default]
      description: Sign in with a social provider
      operationId: socialSignIn
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                callbackURL:
                  type: string
                newUserCallbackURL:
                  type: string
                errorCallbackURL:
                  type: string
                provider:
                  type: string
                disableRedirect:
                  type: string
                idToken:
                  type: string
                scopes:
                  type: string
                requestSignUp:
                  type: string
                loginHint:
                  type: string
              required: [provider]
      responses:
        '200':
          description: Success - Returns either session details or redirect URL
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/AuthSuccessResponse'
                  - type: object
                    properties:
                      url:
                        type: string
                        nullable: true
        <<: *common-error-responses

  /get-session:
    get:
      tags: [Default]
      description: Get the current session
      security: [{ bearerAuth: [] }]
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SessionResponse'
        <<: *common-error-responses

  /sign-out:
    post:
      tags: [Default]
      description: Sign out the current user
      security: [{ bearerAuth: [] }]
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                required: [success]
        <<: *common-error-responses

  /sign-up/email:
    post:
      tags: [Default]
      description: Sign up a user using email and password
      security: [{ bearerAuth: [] }]
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  description: The name of the user
                email:
                  type: string
                  description: The email of the user
                password:
                  type: string
                  description: The password of the user
                image:
                  type: string
                  description: The profile image URL of the user
                callbackURL:
                  type: string
                  description: The URL to use for email verification callback
                rememberMe:
                  type: boolean
                  description: If this is false, the session will not be remembered. Default is `true`.
              required: [name, email, password]
      responses:
        '200':
          description: Successfully created user
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserWithToken'
        <<: *common-error-responses

  /sign-in/email:
    post:
      tags: [Default]
      description: Sign in with email and password
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  description: Email of the user
                password:
                  type: string
                  description: Password of the user
                callbackURL:
                  type: string
                rememberMe:
                  type: string
              required: [email, password]
      responses:
        '200':
          description: Success - Returns either session details or redirect URL
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/AuthSuccessResponse'
                  - type: object
                    properties:
                      url:
                        type: string
                        nullable: true
        <<: *common-error-responses

  /forget-password:
    post:
      tags: [Default]
      description: Send a password reset email to the user
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  description: The email address of the user to send a password reset email to
                redirectTo:
                  type: string
              required: [email]
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StatusWithMessage'
        <<: *common-error-responses

  /reset-password:
    post:
      tags: [Default]
      description: Reset the password for a user
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                newPassword:
                  type: string
                  description: The new password to set
                token:
                  type: string
              required: [newPassword]
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StatusResponse'
        <<: *common-error-responses

  /verify-email:
    get:
      tags: [Default]
      description: Verify the email of the user
      security: [{ bearerAuth: [] }]
      parameters:
        - name: token
          in: query
          description: The token to verify the email
          required: true
          schema:
            type: string
        - name: callbackURL
          in: query
          description: The URL to redirect to after email verification
          required: false
          schema:
            type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  user:
                    $ref: '#/components/schemas/User'
                  status:
                    type: boolean
                    description: Indicates if the email was verified successfully
                required: [user, status]
        <<: *common-error-responses

  /send-verification-email:
    post:
      tags: [Default]
      description: Send a verification email to the user
      security: [{ bearerAuth: [] }]
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  description: The email to send the verification email to
                  example: user@example.com
                callbackURL:
                  type: string
                  description: The URL to use for email verification callback
                  example: https://example.com/callback
                  nullable: true
              required: [email]
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: boolean
                    description: Indicates if the email was sent successfully
                    example: true
                required: [status]
        <<: *common-error-responses

  /change-email:
    post:
      tags: [Default]
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                newEmail:
                  type: string
                  description: The new email address to set must be a valid email address
                callbackURL:
                  type: string
              required: [newEmail]
      responses:
        '200':
          description: Email change request processed successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: boolean
                    description: Indicates if the request was successful
                  message:
                    type: string
                    enum: [Email updated, Verification email sent]
                    description: Status message of the email change process
                    nullable: true
                required: [status]
        <<: *common-error-responses

  /change-password:
    post:
      tags: [Default]
      description: Change the password of the user
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                newPassword:
                  type: string
                  description: The new password to set
                currentPassword:
                  type: string
                  description: The current password is required
                revokeOtherSessions:
                  type: string
              required: [newPassword, currentPassword]
      responses:
        '200':
          description: Password successfully changed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserWithToken'
        <<: *common-error-responses

  /update-user:
    post:
      tags: [Default]
      description: Update the current user
      security: [{ bearerAuth: [] }]
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                name:
                  type: string
                  description: The name of the user
                image:
                  type: string
                  description: The image of the user
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: boolean
                    description: Indicates if the update was successful
                required: [status]
        <<: *common-error-responses

  /delete-user:
    post:
      tags: [Default]
      description: Delete the user
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                callbackURL:
                  type: string
                password:
                  type: string
                token:
                  type: string
      responses:
        '200':
          description: User deletion processed successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    description: Indicates if the operation was successful
                  message:
                    type: string
                    enum: [User deleted, Verification email sent]
                    description: Status message of the deletion process
                required: [success, message]
        <<: *common-error-responses

  /reset-password/{token}:
    get:
      tags: [Default]
      description: Redirects the user to the callback URL with the token
      security: [{ bearerAuth: [] }]
      parameters:
        - name: token
          in: path
          required: true
          schema:
            type: string
        - name: callbackURL
          in: query
          schema:
            type: string
            description: The URL to redirect the user to reset their password
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  token:
                    type: string
                required: [token]
        <<: *common-error-responses

  /request-password-reset:
    post:
      tags: [Default]
      description: Send a password reset email to the user
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                  description: The email address of the user to send a password reset email to
                redirectTo:
                  type: string
              required: [email]
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StatusWithMessage'
        <<: *common-error-responses

  /list-sessions:
    get:
      tags: [Default]
      description: List all active sessions for the user
      security: [{ bearerAuth: [] }]
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Session'
        <<: *common-error-responses

  /revoke-session:
    post:
      tags: [Default]
      description: Revoke a single session
      security: [{ bearerAuth: [] }]
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                token:
                  type: string
                  description: The token to revoke
              required: [token]
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StatusResponse'
        <<: *common-error-responses

  /revoke-sessions:
    post:
      tags: [Default]
      description: Revoke all sessions for the user
      security: [{ bearerAuth: [] }]
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StatusResponse'
        <<: *common-error-responses

  /revoke-other-sessions:
    post:
      tags: [Default]
      description: Revoke all other sessions for the user except the current one
      security: [{ bearerAuth: [] }]
      requestBody:
        content:
          application/json:
            schema:
              type: object
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StatusResponse'
        <<: *common-error-responses

  /link-social:
    post:
      tags: [Default]
      description: Link a social account to the user
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                callbackURL:
                  type: string
                provider:
                  type: string
                idToken:
                  type: string
                requestSignUp:
                  type: string
                scopes:
                  type: string
                errorCallbackURL:
                  type: string
                disableRedirect:
                  type: string
              required: [provider]
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  url:
                    type: string
                    description: The authorization URL to redirect the user to
                  redirect:
                    type: boolean
                    description: Indicates if the user should be redirected to the authorization URL
                  status:
                    type: boolean
                required: [redirect]
        <<: *common-error-responses

  /list-accounts:
    get:
      tags: [Default]
      description: List all accounts linked to the user
      security: [{ bearerAuth: [] }]
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: string
                    provider:
                      type: string
                    createdAt:
                      type: string
                      format: date-time
                    updatedAt:
                      type: string
                      format: date-time
                    accountId:
                      type: string
                    scopes:
                      type: array
                      items:
                        type: string
                  required: [id, provider, createdAt, updatedAt, accountId, scopes]
        <<: *common-error-responses

  /delete-user/callback:
    get:
      tags: [Default]
      description: Callback to complete user deletion with verification token
      security: [{ bearerAuth: [] }]
      parameters:
        - name: token
          in: query
          schema:
            type: string
            description: The token to verify the deletion request
        - name: callbackURL
          in: query
          schema:
            type: string
      responses:
        '200':
          description: User successfully deleted
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    description: Indicates if the deletion was successful
                  message:
                    type: string
                    enum: [User deleted]
                    description: Confirmation message
                required: [success, message]
        <<: *common-error-responses

  /unlink-account:
    post:
      tags: [Default]
      description: Unlink an account
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                providerId:
                  type: string
                accountId:
                  type: string
              required: [providerId]
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StatusResponse'
        <<: *common-error-responses

  /refresh-token:
    post:
      tags: [Default]
      description: Refresh the access token using a refresh token
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                providerId:
                  type: string
                  description: The provider ID for the OAuth provider
                accountId:
                  type: string
                userId:
                  type: string
              required: [providerId]
      responses:
        '200':
          description: Access token refreshed successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenResponse'
        <<: *common-error-responses

  /get-access-token:
    post:
      tags: [Default]
      description: Get a valid access token, doing a refresh if needed
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                providerId:
                  type: string
                  description: The provider ID for the OAuth provider
                accountId:
                  type: string
                userId:
                  type: string
              required: [providerId]
      responses:
        '200':
          description: A Valid access token
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TokenResponse'
        <<: *common-error-responses

  /account-info:
    post:
      tags: [Default]
      description: Get the account info provided by the provider
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                accountId:
                  type: string
                  description: The provider given account id for which to get the account info
              required: [accountId]
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  user:
                    $ref: '#/components/schemas/User'
                  data:
                    type: object
                    additionalProperties: true
                required: [user, data]
        <<: *common-error-responses

  /ok:
    get:
      tags: [Default]
      description: Check if the API is working
      security: [{ bearerAuth: [] }]
      responses:
        '200':
          description: API is working
          content:
            application/json:
              schema:
                type: object
                properties:
                  ok:
                    type: boolean
                    description: Indicates if the API is working
                required: [ok]
        <<: *common-error-responses

  /error:
    get:
      tags: [Default]
      description: Displays an error page
      security: [{ bearerAuth: [] }]
      responses:
        '200':
          description: Success
          content:
            text/html:
              schema:
                type: string
                description: The HTML content of the error page
        <<: *common-error-responses

  # Two-factor authentication endpoints
  /two-factor/get-totp-uri:
    post:
      tags: [Two-factor]
      description: Use this endpoint to get the TOTP URI
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                password:
                  type: string
                  description: User password
              required: [password]
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  totpURI:
                    type: string
                required: [totpURI]
        <<: *common-error-responses

  /two-factor/verify-totp:
    post:
      tags: [Two-factor]
      description: Verify two factor TOTP
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                code:
                  type: string
                  description: 'The otp code to verify. Eg: "012345"'
                trustDevice:
                  type: string
              required: [code]
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StatusResponse'
        <<: *common-error-responses

  /two-factor/send-otp:
    post:
      tags: [Two-factor]
      description: Send two factor OTP to the user
      security: [{ bearerAuth: [] }]
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StatusResponse'
        <<: *common-error-responses

  /two-factor/verify-otp:
    post:
      tags: [Two-factor]
      description: Verify two factor OTP
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                code:
                  type: string
                  description: 'The otp code to verify. Eg: "012345"'
                trustDevice:
                  type: string
                  description: "If true, the device will be trusted for 30 days. It'll be refreshed on every sign in request within this time. Eg: true"
              required: [code]
      responses:
        '200':
          description: Two-factor OTP verified successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  token:
                    type: string
                    description: Session token for the authenticated session
                  user:
                    $ref: '#/components/schemas/User'
                required: [token, user]
        <<: *common-error-responses

  /two-factor/verify-backup-code:
    post:
      tags: [Two-factor]
      description: Verify a backup code for two-factor authentication
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                code:
                  type: string
                  description: 'A backup code to verify. Eg: "123456"'
                disableSession:
                  type: string
                trustDevice:
                  type: string
              required: [code]
      responses:
        '200':
          description: Backup code verified successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  user:
                    $ref: '#/components/schemas/User'
                  session:
                    $ref: '#/components/schemas/Session'
                required: [user, session]
        <<: *common-error-responses

  /two-factor/generate-backup-codes:
    post:
      tags: [Two-factor]
      description: Generate new backup codes for two-factor authentication
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                password:
                  type: string
                  description: The users password.
              required: [password]
      responses:
        '200':
          description: Backup codes generated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: boolean
                    description: Indicates if the backup codes were generated successfully
                    enum: [true]
                  backupCodes:
                    type: array
                    items:
                      type: string
                    description: Array of generated backup codes in plain text
                required: [status, backupCodes]
        <<: *common-error-responses

  /two-factor/enable:
    post:
      tags: [Two-factor]
      description: Use this endpoint to enable two factor authentication. This will generate a TOTP URI and backup codes. Once the user verifies the TOTP URI, the two factor authentication will be enabled.
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                password:
                  type: string
                  description: User password
                issuer:
                  type: string
              required: [password]
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  totpURI:
                    type: string
                    description: TOTP URI
                  backupCodes:
                    type: array
                    items:
                      type: string
                    description: Backup codes
                required: [totpURI, backupCodes]
        <<: *common-error-responses

  /two-factor/disable:
    post:
      tags: [Two-factor]
      description: Use this endpoint to disable two factor authentication.
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                password:
                  type: string
                  description: User password
              required: [password]
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StatusResponse'
        <<: *common-error-responses

  # Multi-session endpoints
  /multi-session/list-device-sessions:
    get:
      tags: [Multi-session]
      security: [{ bearerAuth: [] }]
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Session'
        <<: *common-error-responses

  /multi-session/set-active:
    post:
      tags: [Multi-session]
      description: Set the active session
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                sessionToken:
                  type: string
                  description: The session token to set as active
              required: [sessionToken]
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  session:
                    $ref: '#/components/schemas/Session'
                required: [session]
        <<: *common-error-responses

  /multi-session/revoke:
    post:
      tags: [Multi-session]
      description: Revoke a device session
      security: [{ bearerAuth: [] }]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                sessionToken:
                  type: string
                  description: The session token to revoke
              required: [sessionToken]
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StatusResponse'
        <<: *common-error-responses