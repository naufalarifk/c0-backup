# Settlement Module - Environment Variables Template

# Copy these to your .env file and fill in the values

# ============================================================================
# SETTLEMENT CONFIGURATION
# ============================================================================

# Enable/disable the automated settlement scheduler
# When enabled, settlement runs daily at midnight (00:00 AM)
# Set to 'false' to disable automated settlement
SETTLEMENT_SCHEDULER_ENABLED=true

# Cron schedule for settlement (default: midnight UTC)
# Format: "minute hour day month weekday"
# Examples:
#   "0 0 * * *"   = Every day at midnight
#   "0 */6 * * *" = Every 6 hours
#   "0 2 * * *"   = Every day at 2 AM
SETTLEMENT_CRON_SCHEDULE=0 0 * * *

# Run initial settlement on module initialization (default: false)
# Set to 'true' to run settlement immediately when the app starts
# Useful for development/testing, not recommended for production
SETTLEMENT_RUN_ON_INIT=false

# Percentage of total balance to maintain on Binance Exchange (0-100)
# Example: 50 means 50% on Binance, 50% in hot wallets
# Example: 33 means 33% on Binance, 67% in hot wallets
SETTLEMENT_TARGET_PERCENTAGE=50

# Target network for settlement (default: binance)
# Options: 'binance' or specific blockchain key (e.g., 'eip155:56')
SETTLEMENT_TARGET_NETWORK=binance

# Minimum amount to settle (skip if below this threshold)
# Example: 0.01 means skip settlements smaller than 0.01
SETTLEMENT_MIN_AMOUNT=0.01

# ============================================================================
# BINANCE API CONFIGURATION (REQUIRED FOR FULL FUNCTIONALITY)
# ============================================================================

# Enable Binance Exchange API integration
# When enabled: Uses Binance API for accurate balances and withdrawals
# When disabled: Falls back to blockchain-only approach (BSC address)
BINANCE_API_ENABLED=false

# Binance API Key
# Get from: https://www.binance.com/en/my/settings/api-management
# Required permissions: "Enable Reading", "Enable Withdrawals"
# IMPORTANT: Enable IP whitelist for security
BINANCE_API_KEY=

# Binance API Secret
# This is shown only once when creating the API key - save it securely!
BINANCE_API_SECRET=

# Binance API Base URL (optional)
# Production: https://api.binance.com (default)
# Testnet: https://testnet.binance.vision
BINANCE_API_BASE_URL=https://api.binance.com

# ============================================================================
# PRODUCTION EXAMPLE (with Binance API)
# ============================================================================

# SETTLEMENT_ENABLED=true
# SETTLEMENT_PERCENTAGE=50
# SETTLEMENT_TARGET_NETWORK=eip155:56
# BINANCE_API_ENABLED=true
# BINANCE_API_KEY=vmPUZE6mv9SD5VNHk4HlWFsOr6aKE2zvsw0MuIgwCIPy6utIco14y7Ju91duEh8A
# BINANCE_API_SECRET=NhqPtmdSJYdKjVHjA7PZj4Mge3R5YNiP1e3UZjInClVN65XAbvqqM6A7H5fATj0j
# BINANCE_API_BASE_URL=https://api.binance.com

# ============================================================================
# DEVELOPMENT/TESTING EXAMPLE (with Testnet)
# ============================================================================

# SETTLEMENT_ENABLED=true
# SETTLEMENT_PERCENTAGE=50
# SETTLEMENT_TARGET_NETWORK=eip155:56
# BINANCE_API_ENABLED=true
# BINANCE_API_KEY=testnet_api_key_here
# BINANCE_API_SECRET=testnet_api_secret_here
# BINANCE_API_BASE_URL=https://testnet.binance.vision

# ============================================================================
# MINIMAL EXAMPLE (without Binance API - blockchain only)
# ============================================================================

# SETTLEMENT_ENABLED=true
# SETTLEMENT_PERCENTAGE=50
# SETTLEMENT_TARGET_NETWORK=eip155:56
# BINANCE_API_ENABLED=false

# ============================================================================
# SECURITY NOTES
# ============================================================================

# 1. NEVER commit this file with real credentials to version control
# 2. Use HashiCorp Vault or similar secret management in production
# 3. Enable IP whitelist on Binance API key settings
# 4. Only grant required permissions (Reading + Withdrawals)
# 5. Rotate API keys regularly (every 90 days recommended)
# 6. Monitor API key usage via Binance dashboard
# 7. Set up alerts for unusual withdrawal patterns

# ============================================================================
# TESTING CHECKLIST
# ============================================================================

# Before enabling in production:
# [ ] Test API connectivity: curl https://api.binance.com/api/v3/ping
# [ ] Verify API key has correct permissions
# [ ] Test with small amounts first on testnet
# [ ] Confirm deposit addresses are correct
# [ ] Test withdrawal flow end-to-end
# [ ] Set up monitoring and alerts
# [ ] Document incident response procedures

# ============================================================================
# TROUBLESHOOTING
# ============================================================================

# Issue: "Binance API client not initialized"
# Solution: Check BINANCE_API_KEY and BINANCE_API_SECRET are set correctly

# Issue: "IP address not whitelisted"
# Solution: Add server IP to Binance API key whitelist

# Issue: Withdrawals failing
# Solution: Check API key has "Enable Withdrawals" permission

# Issue: "Daily withdrawal limit exceeded"
# Solution: Wait 24 hours or increase verification level on Binance

# For more help, see: src/modules/settlement/BINANCE_INTEGRATION.md
